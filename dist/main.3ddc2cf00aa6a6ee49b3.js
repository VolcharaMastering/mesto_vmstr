!function(){"use strict";var e="9ccf29bd-3d67-4cc8-8c99-82c18d019a44",t={activeForm:".popup__inputs",formInput:".popup__input",popupSaveButton:".popup__save",popupDisableButton:"popup__save_disable",inputError:"popup__input_type_error",activeError:"popup__input_error_active"},n=document.querySelector(".gallery"),r=document.forms.profile,o=document.forms.addImage;function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=function(){function e(t,n,r,o,i,c){var u=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,"_getTemplate",(function(){return document.querySelector(u._selector).content.cloneNode(!0)})),a(this,"_deleteImage",(function(e){u._cardTemplate=null,e.target.closest(".card").remove()})),a(this,"_addEvents",(function(){u._cardRemove.addEventListener("click",u._deleteImage),u._cardLike.addEventListener("click",(function(){u._like?(u._getLikes=u._delLike(u._cardId),console.log(u._getLikes),u._addLikeCounter()):(u._getLikes=u._addLike(u._cardId),console.log(u._getLikes),u._addLikeCounter()),u._cardLike.classList.toggle("card__like_active")})),u._cardImage.addEventListener("click",(function(){u._handleCardClick(u._newCardName,u._imageLink)}))})),a(this,"_checkLikes",(function(){u._getLikes.length>0&&null!=u._getLikes.find((function(e){return e._id==u._myId}))&&(u._cardLike.classList.add("card__like_active"),u._like=!0)})),a(this,"_addLikeCounter",(function(){u._likeNumber.textContent=u._getLikes.length})),this._newCardName=t.name,this._imageLink=t.link,this._getLikes=t.likes,this._cardId=t._id,this._selector=n,this._handleCardClick=r,this._delLike=o,this._addLike=i,this._myId=c,this._like=!1}var t,n;return t=e,(n=[{key:"makeCard",value:function(){return console.log("MyID="+this._myId),this._cardTemplate=this._getTemplate(),this._cardImage=this._cardTemplate.querySelector(".card__image"),this._cardName=this._cardTemplate.querySelector(".card__name"),this._cardRemove=this._cardTemplate.querySelector(".card__remove"),this._cardLike=this._cardTemplate.querySelector(".card__like"),this._likeNumber=this._cardTemplate.querySelector(".card__like-count"),this._checkLikes(),this._addLikeCounter(),this._cardImage.setAttribute("src",this._imageLink),this._cardImage.setAttribute("alt","Фото из галереи: "+this._newCardName),this._cardName.textContent=this._newCardName,this._addEvents(),this._cardTemplate}}])&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=r,this._renderer=o,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"clear",value:function(){this._container.innerHTML=""}},{key:"renderItems",value:function(){var e=this;this.clear(),this._items.forEach((function(t){return e._renderer(t)}))}},{key:"prepends",value:function(e){this._container.prepend(e)}},{key:"appends",value:function(e){this._container.append(e)}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=p((function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f(this,"_setEventListeners",(function(){r._toggleButtonState(),r._inputArray.forEach((function(e){e.addEventListener("input",(function(){r._checkInputValidity(e),r._toggleButtonState()}))}))})),f(this,"enableValidation",(function(){r._setEventListeners()})),f(this,"_showInputError",(function(e,t){var n=r._form.querySelector(".".concat(e.id,"-error"));e.classList.add(r._inputError),n.classList.add(r._activeError),n.textContent=t})),f(this,"_hideInputError",(function(e){var t=r._form.querySelector(".".concat(e.id,"-error"));e.classList.remove(r._inputError),t.classList.remove(r._activeError),t.textContent=""})),f(this,"_checkInputValidity",(function(e){e.validity.valid?r._hideInputError(e):r._showInputError(e,e.validationMessage)})),f(this,"_hasInvalidInput",(function(){return r._inputArray.some((function(e){return!e.validity.valid}))})),f(this,"_toggleButtonState",(function(){r._hasInvalidInput()?(r._saveButton.classList.add(r._popupDisableButton),r._saveButton.setAttribute("disabled","disabled")):(r._saveButton.classList.remove(r._popupDisableButton),r._saveButton.removeAttribute("disabled"))})),f(this,"resetValidation",(function(){r._toggleButtonState(),r._inputArray.forEach((function(e){r._hideInputError(e)}))})),this._activeForm=t.activeForm,this._formInput=t.formInput,this._popupSaveButton=t.popupSaveButton,this._popupDisableButton=t.popupDisableButton,this._inputError=t.inputError,this._activeError=t.activeError,this._form=n,this._inputArray=Array.from(this._form.querySelectorAll(this._formInput)),this._saveButton=this._form.querySelector(this._popupSaveButton)}));function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function e(t){var n,r,o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(){document.addEventListener("keydown",o._escCloseListen=function(e){"Escape"===e.key&&o.close()})},(n="_handleEscClose")in this?Object.defineProperty(this,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[n]=r,this._popup=document.querySelector(t)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.add("popup_active"),this._handleEscClose()}},{key:"close",value:function(){this._popup.classList.remove("popup_active"),document.removeEventListener("keydown",this._escCloseListen)}},{key:"setEventListeners",value:function(){var e=this;this._popup.addEventListener("click",this._closeListener=function(t){(t.target===t.currentTarget||t.target.classList.contains("popup__close"))&&e.close()})}}])&&_(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function v(e,t){return v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},v(e,t)}function m(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=k(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},g.apply(this,arguments)}function k(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}var L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(i,e);var t,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(n);if(r){var o=w(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return m(this,e)});function i(e){var t,n,r,a,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),c=function(e,r){n._bigImage.setAttribute("src",r),n._bigImage.setAttribute("alt","Увеличенное фото из галереи: "+e),n._bigImageCaption.textContent=e,g((t=b(n),w(i.prototype)),"open",t).call(t)},(a="open")in(r=b(n=o.call(this,e)))?Object.defineProperty(r,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):r.open=c,n._bigImage=n._popup.querySelector(".popup__image"),n._bigImageCaption=n._popup.querySelector(".popup__image-caption"),n}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(h);function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(){return j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=I(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},j.apply(this,arguments)}function I(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}function S(e,t){return S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},S(e,t)}function C(e,t){if(t&&("object"===E(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(r);if(o){var n=P(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return C(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e))._form=n._popup.querySelector(".popup__inputs"),n._inputArray=n._popup.querySelectorAll(".popup__input"),n._submitForm=t,n}return t=a,(n=[{key:"_getInputValues",value:function(){var e={};return this._inputArray.forEach((function(t){e[t.name]=t.value})),e}},{key:"setEventListeners",value:function(){var e=this;this._form.addEventListener("submit",this._submitListener=function(t){t.preventDefault(),e._submitForm(e._getInputValues())}),j(P(a.prototype),"setEventListeners",this).call(this)}},{key:"close",value:function(){j(P(a.prototype),"close",this).call(this),this._form.reset()}}])&&O(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(h);function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var q=function(){function e(t){var n=t.userName,r=t.description;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=document.querySelector(n),this._description=document.querySelector(r)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{userName:this._name.textContent,descript:this._description.textContent}}},{key:"setUserInfo",value:function(e){this._name.textContent=e.name,this._description.textContent=e.description}}])&&B(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var A=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._url="https://mesto.nomoreparties.co/v1/cohort-43/",this._token=n,this._forUrl=t,this._headers={"Content-type":"application/json",authorization:"9ccf29bd-3d67-4cc8-8c99-82c18d019a44"}}var t,n;return t=e,(n=[{key:"getData",value:function(){return fetch(this._url+this._forUrl,{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Bug detected!")}))}},{key:"delLike",value:function(e){return fetch(this._url+e,{headers:this._headers,method:"DELETE"}).then((function(e){return e.ok?e.json():Promise.reject("Bug detected!")}))}},{key:"addLike",value:function(e){return fetch(this._url+e,{headers:this._headers,method:"PUT"}).then((function(e){return e.ok?e.json():Promise.reject("Bug detected!")}))}},{key:"setCard",value:function(){}}])&&R(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),D=r.elements.name,x=r.elements.description,N=n.querySelector(".profile__edit-button"),V=n.querySelector(".profile__add-button");new A("users/me",e).getData().then((function(e){window.myId=e._id,console.log("usersInfo",e)})).catch((function(e){console.log(e)}));var U=function(e,t){G.open(e,t)},F=function(e){z.delLike("cards/".concat(e,"/likes")).then((function(e){return e.json()})).catch((function(e){console.log(e)})),console.log("del LIKE")},M=function(e){z.addLike("cards/".concat(e,"/likes")).then((function(e){return e.json()})).catch((function(e){console.log(e)})),console.log("add LIKE")},K=function(e){return new c(e,".template-card",U,F,M,myId).makeCard()},z=new A("cards",e);z.getData().then((function(e){var t=new s({items:e,renderer:function(e){var n=K(e);t.appends(n)}},".photos");t.renderItems()})).catch((function(e){console.log(e)}));var G=new L(".popup_big-image");G.setEventListeners();var H=new T(".popup_adder",(function(e){var t=K(e);addGalary.prepends(t),H.close()}));H.setEventListeners();var J=new q({userName:".profile__name",description:".profile__description"}),Q=new T(".popup_editor",(function(e){J.setUserInfo(e),Q.close()}));Q.setEventListeners();var W=new d(t,r);W.enableValidation();var X=new d(t,o);X.enableValidation(),V.addEventListener("click",(function(){H.open(),X.resetValidation()})),N.addEventListener("click",(function(){Q.open();var e=J.getUserInfo();D.value=e.userName,x.value=e.descript,W.resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFFBQVM3SSxHQUVsQzJLLEVBQVNWLFVBQ05aLE1BQUssU0FBQzBCLEdBQ0wsSUFBTUMsRUFBWSxJQUFJOUcsRUFBUSxDQUM1QkUsTUFBTzJHLEVBQ1AxRyxTQUFVLFNBQUNwRCxHQUNULElBQU1nSyxFQUFhTCxFQUFXM0osR0FDOUIrSixFQUFVRSxRQUFRRCxLQUVuQixXQUNIRCxFQUFVRyxpQkFFWGYsT0FBTSxTQUFDQyxHQUNOOUgsUUFBUUMsSUFBSTZILE1BS2hCLElBQU1HLEVBQVcsSUFBSTlDLEVBQWUsb0JBQ3BDOEMsRUFBU1ksb0JBRVQsSUFBTUMsRUFBZ0IsSUFBSXhELEVBQ3hCLGdCQUNBLFNBQUNnRCxHQUNDLElBQU1JLEVBQWFMLEVBQVdDLEdBQzlCRyxVQUFVTSxTQUFTTCxHQUNuQkksRUFBY2xFLFdBR2xCa0UsRUFBY0Qsb0JBRWQsSUFBTUcsRUFBVyxJQUFJakQsRUE3RkcsQ0FDdEJDLFNBQVUsaUJBQ1ZDLFlBQWEsMEJBNkZUZ0QsRUFBZSxJQUFJM0QsRUFDdkIsaUJBQ0EsU0FBQ2UsR0FDQzJDLEVBQVNFLFlBQVk3QyxHQUNyQjRDLEVBQWFyRSxXQUdqQnFFLEVBQWFKLG9CQUdiLElBQU1NLEVBQXNCLElBQUkzRyxFQUFjOUUsRUFBZ0JVLEdBQzlEK0ssRUFBb0JDLG1CQUVwQixJQUFNQyxFQUFtQixJQUFJN0csRUFBYzlFLEVBQWdCYSxHQUMzRDhLLEVBQWlCRCxtQkFLakIzQixFQUFjaEksaUJBQWlCLFNBQVMsV0FDdENxSixFQUFjWixPQUNkbUIsRUFBaUJDLHFCQUduQjlCLEVBQWtCL0gsaUJBQWlCLFNBQVMsV0FDMUN3SixFQUFhZixPQUNiLElBQU1xQixFQUFhUCxFQUFTUSxjQUM1Qm5DLEVBQVUzQixNQUFRNkQsRUFBV3ZELFNBQzdCdUIsRUFBZTdCLE1BQVE2RCxFQUFXbkQsU0FDbEMrQyxFQUFvQkcscUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL3ZhcmlhYmxlcy5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgdG9rZW49JzljY2YyOWJkLTNkNjctNGNjOC04Yzk5LTgyYzE4ZDAxOWE0NCc7XHJcblxyXG5jb25zdCB1c2VyUHJvZmlsZSA9IFtcclxuICB7XHJcbiAgICBuYW1lOiAnLnByb2ZpbGVfX25hbWUnLFxyXG4gICAgZGVzY3JpcHQ6ICcucHJvZmlsZV9fZGVzY3JpcHRpb24nXHJcbiAgfVxyXG5dO1xyXG5cclxuY29uc3QgdmFsaWRhdGlvbkxpc3QgPSB7XHJcbiAgYWN0aXZlRm9ybTogJy5wb3B1cF9faW5wdXRzJyxcclxuICBmb3JtSW5wdXQ6ICcucG9wdXBfX2lucHV0JyxcclxuICBwb3B1cFNhdmVCdXR0b246ICcucG9wdXBfX3NhdmUnLFxyXG4gIHBvcHVwRGlzYWJsZUJ1dHRvbjogJ3BvcHVwX19zYXZlX2Rpc2FibGUnLFxyXG4gIGlucHV0RXJyb3I6ICdwb3B1cF9faW5wdXRfdHlwZV9lcnJvcicsXHJcbiAgYWN0aXZlRXJyb3I6ICdwb3B1cF9faW5wdXRfZXJyb3JfYWN0aXZlJ1xyXG59O1xyXG5cclxuY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nYWxsZXJ5Jyk7XHJcbmNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXMucHJvZmlsZTtcclxuY29uc3QgY2FyZEZvcm0gPSBkb2N1bWVudC5mb3Jtcy5hZGRJbWFnZTtcclxuXHJcbmV4cG9ydCB7dG9rZW4sIG1haW4sIHByb2ZpbGVGb3JtLCBjYXJkRm9ybSwgdmFsaWRhdGlvbkxpc3R9OyIsImV4cG9ydCBjbGFzcyBDYXJkIHtcclxuICAgIGNvbnN0cnVjdG9yKGl0ZW0sIHNlbGVjdG9yVGVtcGxhdGUsIGhhbmRsZUNhcmRDbGljaywgZGVsTGlrZSxhZGRMaWtlLG15SWQpIHtcclxuICAgICAgICB0aGlzLl9uZXdDYXJkTmFtZSA9IGl0ZW0ubmFtZTtcclxuICAgICAgICB0aGlzLl9pbWFnZUxpbmsgPSBpdGVtLmxpbms7XHJcbiAgICAgICAgdGhpcy5fZ2V0TGlrZXMgPSBpdGVtLmxpa2VzO1xyXG4gICAgICAgIHRoaXMuX2NhcmRJZCA9IGl0ZW0uX2lkO1xyXG4gICAgICAgIHRoaXMuX3NlbGVjdG9yID0gc2VsZWN0b3JUZW1wbGF0ZTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICAgICAgdGhpcy5fZGVsTGlrZSA9IGRlbExpa2U7XHJcbiAgICAgICAgdGhpcy5fYWRkTGlrZT1hZGRMaWtlO1xyXG4gICAgICAgIHRoaXMuX215SWQ9bXlJZDtcclxuICAgICAgICB0aGlzLl9saWtlPWZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIF9nZXRUZW1wbGF0ZSA9ICgpID0+IHtcclxuICAgICAgICBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudFxyXG4gICAgICAgICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9zZWxlY3RvcilcclxuICAgICAgICAgICAgLmNvbnRlbnQuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgIHJldHVybiBjYXJkVGVtcGxhdGU7XHJcbiAgICB9XHJcblxyXG4gICAgX2RlbGV0ZUltYWdlID0gKGV2dCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NhcmRUZW1wbGF0ZSA9IG51bGw7XHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbG9zZXN0KCcuY2FyZCcpLnJlbW92ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIF9hZGRFdmVudHMgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2FyZFJlbW92ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2RlbGV0ZUltYWdlKTtcclxuICAgICAgICB0aGlzLl9jYXJkTGlrZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2xpa2Upe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ2V0TGlrZXMgPXRoaXMuX2RlbExpa2UodGhpcy5fY2FyZElkKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuX2dldExpa2VzKTtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMuX2dldExpa2VzID0gbmV3TGlrZXM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRMaWtlQ291bnRlcigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9nZXRMaWtlcyA9dGhpcy5fYWRkTGlrZSh0aGlzLl9jYXJkSWQpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5fZ2V0TGlrZXMpO1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5fZ2V0TGlrZXMgPSBuZXdMaWtlcztcclxuICAgICAgICAgICAgICAgIHRoaXMuX2FkZExpa2VDb3VudGVyKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fY2FyZExpa2UuY2xhc3NMaXN0LnRvZ2dsZSgnY2FyZF9fbGlrZV9hY3RpdmUnKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uZXdDYXJkTmFtZSwgdGhpcy5faW1hZ2VMaW5rKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIF9jaGVja0xpa2VzID0gKCkgPT4ge1xyXG4gICAgICAgIGlmICh0aGlzLl9nZXRMaWtlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlzTGlrZSA9IHRoaXMuX2dldExpa2VzLmZpbmQoaXRlbSA9PiBpdGVtLl9pZCA9PSB0aGlzLl9teUlkKTtcclxuICAgICAgICAgICAgaWYgKGlzTGlrZSAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NhcmRMaWtlLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2VfYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9saWtlPXRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfYWRkTGlrZUNvdW50ZXIgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fbGlrZU51bWJlci50ZXh0Q29udGVudCA9IHRoaXMuX2dldExpa2VzLmxlbmd0aDtcclxuICAgIH07XHJcbiAgICBtYWtlQ2FyZCgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnTXlJRD0nK3RoaXMuX215SWQpO1xyXG4gICAgICAgIHRoaXMuX2NhcmRUZW1wbGF0ZSA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1hZ2UnKTtcclxuICAgICAgICB0aGlzLl9jYXJkTmFtZSA9IHRoaXMuX2NhcmRUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbmFtZScpO1xyXG4gICAgICAgIHRoaXMuX2NhcmRSZW1vdmUgPSB0aGlzLl9jYXJkVGVtcGxhdGUucXVlcnlTZWxlY3RvcignLmNhcmRfX3JlbW92ZScpO1xyXG4gICAgICAgIHRoaXMuX2NhcmRMaWtlID0gdGhpcy5fY2FyZFRlbXBsYXRlLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlJyk7XHJcbiAgICAgICAgdGhpcy5fbGlrZU51bWJlciA9IHRoaXMuX2NhcmRUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudCcpO1xyXG4gICAgICAgIHRoaXMuX2NoZWNrTGlrZXMoKTtcclxuICAgICAgICB0aGlzLl9hZGRMaWtlQ291bnRlcigpO1xyXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZS5zZXRBdHRyaWJ1dGUoJ3NyYycsIHRoaXMuX2ltYWdlTGluayk7XHJcbiAgICAgICAgdGhpcy5fY2FyZEltYWdlLnNldEF0dHJpYnV0ZSgnYWx0JywgJ9Ck0L7RgtC+INC40Lcg0LPQsNC70LXRgNC10Lg6ICcgKyB0aGlzLl9uZXdDYXJkTmFtZSk7XHJcbiAgICAgICAgdGhpcy5fY2FyZE5hbWUudGV4dENvbnRlbnQgPSB0aGlzLl9uZXdDYXJkTmFtZTtcclxuICAgICAgICB0aGlzLl9hZGRFdmVudHMoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY2FyZFRlbXBsYXRlO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIHNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgY2xlYXIoKSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIuaW5uZXJIVE1MID0gJyc7XHJcbiAgfVxyXG5cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLmNsZWFyKCk7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB0aGlzLl9yZW5kZXJlcihpdGVtKSlcclxuICB9XHJcblxyXG5cclxuICBwcmVwZW5kcyhpdGVtSHRtbCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoaXRlbUh0bWwpXHJcbiAgfVxyXG4gIGFwcGVuZHMoaXRlbUh0bWwpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoaXRlbUh0bWwpXHJcbiAgfVxyXG59XHJcblxyXG4iLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgICBjb25zdHJ1Y3RvcihsaXN0LCBmb3JtQWN0aXZlKSB7XHJcbiAgICAgICAgdGhpcy5fYWN0aXZlRm9ybSA9IGxpc3QuYWN0aXZlRm9ybTtcclxuICAgICAgICB0aGlzLl9mb3JtSW5wdXQgPSBsaXN0LmZvcm1JbnB1dDtcclxuICAgICAgICB0aGlzLl9wb3B1cFNhdmVCdXR0b24gPSBsaXN0LnBvcHVwU2F2ZUJ1dHRvbjtcclxuICAgICAgICB0aGlzLl9wb3B1cERpc2FibGVCdXR0b24gPSBsaXN0LnBvcHVwRGlzYWJsZUJ1dHRvbjtcclxuICAgICAgICB0aGlzLl9pbnB1dEVycm9yID0gbGlzdC5pbnB1dEVycm9yO1xyXG4gICAgICAgIHRoaXMuX2FjdGl2ZUVycm9yID0gbGlzdC5hY3RpdmVFcnJvcjtcclxuICAgICAgICB0aGlzLl9mb3JtID0gZm9ybUFjdGl2ZTtcclxuICAgICAgICB0aGlzLl9pbnB1dEFycmF5ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fZm9ybUlucHV0KSk7XHJcbiAgICAgICAgdGhpcy5fc2F2ZUJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9wb3B1cFNhdmVCdXR0b24pO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX2lucHV0QXJyYXkuZm9yRWFjaCgoaW5wdXRzKSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0cy5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dHMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZW5hYmxlVmFsaWRhdGlvbiA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfTtcclxuXHJcbiAgICBfc2hvd0lucHV0RXJyb3IgPSAodmFsaWRFbGVtZW50LCBlcnJvck1lc3NhZ2UpID0+IHtcclxuICAgICAgICBjb25zdCBlcnJvckluRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7dmFsaWRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgICAgIHZhbGlkRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3IpO1xyXG4gICAgICAgIGVycm9ySW5FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fYWN0aXZlRXJyb3IpO1xyXG4gICAgICAgIGVycm9ySW5FbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgfVxyXG5cclxuICAgIF9oaWRlSW5wdXRFcnJvciA9ICh2YWxpZEVsZW1lbnQpID0+IHtcclxuICAgICAgICBjb25zdCBlcnJvckluRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7dmFsaWRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgICAgIHZhbGlkRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3IpO1xyXG4gICAgICAgIGVycm9ySW5FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fYWN0aXZlRXJyb3IpO1xyXG4gICAgICAgIGVycm9ySW5FbGVtZW50LnRleHRDb250ZW50ID0gJyc7XHJcbiAgICB9XHJcblxyXG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eSA9ICh2YWxpZEVsZW1lbnQpID0+IHtcclxuICAgICAgICBpZiAoIXZhbGlkRWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcih2YWxpZEVsZW1lbnQsIHZhbGlkRWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgdGhpcy5faGlkZUlucHV0RXJyb3IodmFsaWRFbGVtZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBfaGFzSW52YWxpZElucHV0ID0gKCkgPT4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pbnB1dEFycmF5LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBfdG9nZ2xlQnV0dG9uU3RhdGUgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3NhdmVCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9wb3B1cERpc2FibGVCdXR0b24pO1xyXG4gICAgICAgICAgICB0aGlzLl9zYXZlQnV0dG9uLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3NhdmVCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9wb3B1cERpc2FibGVCdXR0b24pO1xyXG4gICAgICAgICAgICB0aGlzLl9zYXZlQnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVzZXRWYWxpZGF0aW9uID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgdGhpcy5faW5wdXRBcnJheS5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgY2xhc3MgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3Ioc2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xyXG4gICAgfVxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9hY3RpdmUnKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX2FjdGl2ZScpO1xyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9lc2NDbG9zZUxpc3Rlbik7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUVzY0Nsb3NlID0gKCkgPT4ge1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9lc2NDbG9zZUxpc3RlbiA9IChldnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2Nsb3NlTGlzdGVuZXIgPSAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldCB8fCBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2Nsb3NlJykpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHNlbGVjdG9yKSB7XHJcbiAgICAgICAgc3VwZXIoc2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2JpZ0ltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpO1xyXG4gICAgICAgIHRoaXMuX2JpZ0ltYWdlQ2FwdGlvbj10aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlLWNhcHRpb24nKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuID0gKG5hbWUsIGxpbmspID0+IHtcclxuICAgICAgICB0aGlzLl9iaWdJbWFnZS5zZXRBdHRyaWJ1dGUoJ3NyYycsIGxpbmspO1xyXG4gICAgICAgIHRoaXMuX2JpZ0ltYWdlLnNldEF0dHJpYnV0ZSgnYWx0JywgJ9Cj0LLQtdC70LjRh9C10L3QvdC+0LUg0YTQvtGC0L4g0LjQtyDQs9Cw0LvQtdGA0LXQuDogJyArIG5hbWUpO1xyXG4gICAgICAgIHRoaXMuX2JpZ0ltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgfVxyXG59XHJcblxyXG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHNlbGVjdG9yLCBzdWJtaXRGb3JtKSB7XHJcbiAgICAgICAgc3VwZXIoc2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0cycpO1xyXG4gICAgICAgIHRoaXMuX2lucHV0QXJyYXkgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0Jyk7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0Rm9ybSA9IHN1Ym1pdEZvcm07XHJcbiAgICB9XHJcblxyXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgICAgIGNvbnN0IG5ld1ZhbHVlcyA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2lucHV0QXJyYXkuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgICAgICAgbmV3VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIG5ld1ZhbHVlcztcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuX3N1Ym1pdExpc3RlbmVyID0gKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgdGhpcy5fc3VibWl0Rm9ybSh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICAgICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIFVzZXJJbmZvIHtcclxuICAgIGNvbnN0cnVjdG9yKHsgdXNlck5hbWUsIGRlc2NyaXB0aW9uIH0pIHtcclxuICAgICAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyTmFtZSk7XHJcbiAgICAgICAgdGhpcy5fZGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRlc2NyaXB0aW9uKTtcclxuICAgIH1cclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICAgIGNvbnN0IGdldEluZm8gPSB7XHJcbiAgICAgICAgICAgIHVzZXJOYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxyXG4gICAgICAgICAgICBkZXNjcmlwdDogdGhpcy5fZGVzY3JpcHRpb24udGV4dENvbnRlbnRcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBnZXRJbmZvO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJJbmZvKG5ld0lucHV0cykge1xyXG4gICAgICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuZXdJbnB1dHMubmFtZTtcclxuICAgICAgICB0aGlzLl9kZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IG5ld0lucHV0cy5kZXNjcmlwdGlvbjtcclxuICAgIH1cclxufSIsImV4cG9ydCBjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3IoZm9yVXJsLHRva2VuKSB7XHJcbiAgICAgICAgdGhpcy5fdXJsID0gJ2h0dHBzOi8vbWVzdG8ubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtNDMvJztcclxuICAgICAgICB0aGlzLl90b2tlbiA9IHRva2VuO1xyXG4gICAgICAgIHRoaXMuX2ZvclVybD1mb3JVcmw7XHJcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IHtcclxuICAgICAgICAgICAgJ0NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICAgJ2F1dGhvcml6YXRpb24nOiAnOWNjZjI5YmQtM2Q2Ny00Y2M4LThjOTktODJjMThkMDE5YTQ0J1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXREYXRhKCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl91cmwrdGhpcy5fZm9yVXJsLCB7IGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMgfSlcclxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCdCdWcgZGV0ZWN0ZWQhJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBkZWxMaWtlKGZvclVybCl7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX3VybCtmb3JVcmwsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJ1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ0J1ZyBkZXRlY3RlZCEnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0gXHJcblxyXG4gICAgYWRkTGlrZShmb3JVcmwpe1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl91cmwrZm9yVXJsLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCdcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCdCdWcgZGV0ZWN0ZWQhJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9IFxyXG5cclxuICAgIHNldENhcmQoKXtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbn0iLCJpbXBvcnQgeyB0b2tlbiwgbWFpbiwgcHJvZmlsZUZvcm0sIGNhcmRGb3JtLCB2YWxpZGF0aW9uTGlzdCB9IGZyb20gXCIuL2NvbXBvbmVudHMvdmFyaWFibGVzXCI7XHJcbmltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi9jb21wb25lbnRzL0NhcmRcIjtcclxuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSBcIi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSBcIi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgeyBQb3B1cFdpdGhGb3JtIH0gZnJvbSBcIi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSBcIi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgeyBBcGkgfSBmcm9tIFwiLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgXCIuL3N0eWxlcy9pbmRleC5jc3NcIjtcclxuXHJcblxyXG5jb25zdCBwcm9maWxlRGVzY3JpYmUgPSB7XHJcbiAgdXNlck5hbWU6ICcucHJvZmlsZV9fbmFtZScsXHJcbiAgZGVzY3JpcHRpb246ICcucHJvZmlsZV9fZGVzY3JpcHRpb24nXHJcbn07XHJcbmNvbnN0IGlucHV0TmFtZSA9IHByb2ZpbGVGb3JtLmVsZW1lbnRzLm5hbWU7XHJcbmNvbnN0IGlucHV0bkRlc2NyaXB0ID0gcHJvZmlsZUZvcm0uZWxlbWVudHMuZGVzY3JpcHRpb247XHJcblxyXG5cclxuLy8tLS0tLWJ1dHRvbnMtLS0tLS0tXHJcbmNvbnN0IHByb2ZpbGVPcGVuQnV0dG9uID0gbWFpbi5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcclxuY29uc3QgY2FyZEFkZEJ1dHRvbiA9IG1haW4ucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcclxuXHJcblxyXG5jb25zdCBhcGlVc2VyID0gbmV3IEFwaSgndXNlcnMvbWUnLCB0b2tlbik7XHJcbmFwaVVzZXIuZ2V0RGF0YSgpXHJcbiAgLnRoZW4oKHVzZXJzSW5mbykgPT4ge1xyXG4gICAgd2luZG93Lm15SWQgPSB1c2Vyc0luZm8uX2lkO1xyXG4gICAgY29uc29sZS5sb2coJ3VzZXJzSW5mbycsIHVzZXJzSW5mbyk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICB9KTtcclxuLy89PT09PT09ZnVuY3Rpb25zPT09PT09PT09XHJcbmNvbnN0IGhhbmRsZUNhcmRDbGljayA9IChjYXJkTmFtZSwgY2FyZExpbmspID0+IHtcclxuICBiaWdJbWFnZS5vcGVuKGNhcmROYW1lLCBjYXJkTGluayk7XHJcbn1cclxuXHJcbmNvbnN0IGRlbExpa2UgPSAoY2FyZElkKSA9PiB7XHJcbiAgYXBpQ2FyZHMuZGVsTGlrZShgY2FyZHMvJHtjYXJkSWR9L2xpa2VzYClcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gIH0pO1xyXG4gIFxyXG4gIGNvbnNvbGUubG9nKFwiZGVsIExJS0VcIik7XHJcbn1cclxuXHJcbmNvbnN0IGFkZExpa2UgPSAoY2FyZElkKSA9PiB7XHJcbiAgYXBpQ2FyZHMuYWRkTGlrZShgY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCkgIFxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfSk7XHJcbiAgXHJcbiAgY29uc29sZS5sb2coXCJhZGQgTElLRVwiKTtcclxufVxyXG5cclxuY29uc3QgYWRkTmV3Q2FyZCA9IChkZXNjcmliZSkgPT4ge1xyXG4gIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChkZXNjcmliZSwgJy50ZW1wbGF0ZS1jYXJkJywgaGFuZGxlQ2FyZENsaWNrLCBkZWxMaWtlLCBhZGRMaWtlLCBteUlkKTtcclxuICBjb25zdCBuZXdSZXR1cm5DYXJkID0gbmV3Q2FyZC5tYWtlQ2FyZCgpO1xyXG4gIHJldHVybiBuZXdSZXR1cm5DYXJkO1xyXG59XHJcblxyXG5cclxuLy89PT09PT09Y2xhc3NlcyBhbmQgY2FsbGJhY2tzPT09PT09PT09XHJcblxyXG4vLy8vLy8vLy8tLWdldHRpbmcgY2FyZHMgZnJvbSBzZXJ2ZXItLS8vLy8vLy8vXHJcbmNvbnN0IGFwaUNhcmRzID0gbmV3IEFwaSgnY2FyZHMnLCB0b2tlbik7XHJcblxyXG5hcGlDYXJkcy5nZXREYXRhKClcclxuICAudGhlbigoZGJDYXJkcykgPT4ge1xyXG4gICAgY29uc3QgYWRkR2FsYXJ5ID0gbmV3IFNlY3Rpb24oe1xyXG4gICAgICBpdGVtczogZGJDYXJkcyxcclxuICAgICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XHJcbiAgICAgICAgY29uc3QgcmV0dXJuQ2FyZCA9IGFkZE5ld0NhcmQoaXRlbSk7XHJcbiAgICAgICAgYWRkR2FsYXJ5LmFwcGVuZHMocmV0dXJuQ2FyZCk7XHJcbiAgICAgIH1cclxuICAgIH0sIFwiLnBob3Rvc1wiKTtcclxuICAgIGFkZEdhbGFyeS5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfSk7XHJcblxyXG5cclxuXHJcbmNvbnN0IGJpZ0ltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKCcucG9wdXBfYmlnLWltYWdlJyk7XHJcbmJpZ0ltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBwb3B1cENhcmRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgJy5wb3B1cF9hZGRlcicsXHJcbiAgKGRlc2NyaWJlKSA9PiB7XHJcbiAgICBjb25zdCByZXR1cm5DYXJkID0gYWRkTmV3Q2FyZChkZXNjcmliZSk7XHJcbiAgICBhZGRHYWxhcnkucHJlcGVuZHMocmV0dXJuQ2FyZCk7XHJcbiAgICBwb3B1cENhcmRGb3JtLmNsb3NlKCk7XHJcbiAgfVxyXG4pO1xyXG5wb3B1cENhcmRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhwcm9maWxlRGVzY3JpYmUpO1xyXG5cclxuY29uc3QgcG9wdXBQcm9maWxlID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgJy5wb3B1cF9lZGl0b3InLFxyXG4gIChuZXdJbnB1dHMpID0+IHtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKG5ld0lucHV0cyk7XHJcbiAgICBwb3B1cFByb2ZpbGUuY2xvc2UoKTtcclxuICB9XHJcbik7XHJcbnBvcHVwUHJvZmlsZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8tLS0tLS0tLWVuYWJsZSB2YWxpZGF0aW9uLS0tLS0tLS0tLVxyXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRlID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkxpc3QsIHByb2ZpbGVGb3JtKTtcclxucHJvZmlsZUZvcm1WYWxpZGF0ZS5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCBjYXJkRm9ybVZhbGlkYXRlID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkxpc3QsIGNhcmRGb3JtKTtcclxuY2FyZEZvcm1WYWxpZGF0ZS5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5cclxuLy89PT09PT09PT09YnV0dG9ucyBsaXN0ZW5lcnM9PT09PT09PT09PVxyXG5cclxuY2FyZEFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBwb3B1cENhcmRGb3JtLm9wZW4oKTtcclxuICBjYXJkRm9ybVZhbGlkYXRlLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KVxyXG5cclxucHJvZmlsZU9wZW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgcG9wdXBQcm9maWxlLm9wZW4oKTtcclxuICBjb25zdCBvbGRQcm9maWxlID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBpbnB1dE5hbWUudmFsdWUgPSBvbGRQcm9maWxlLnVzZXJOYW1lO1xyXG4gIGlucHV0bkRlc2NyaXB0LnZhbHVlID0gb2xkUHJvZmlsZS5kZXNjcmlwdDtcclxuICBwcm9maWxlRm9ybVZhbGlkYXRlLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KVxyXG5cclxuIl0sIm5hbWVzIjpbInRva2VuIiwidmFsaWRhdGlvbkxpc3QiLCJhY3RpdmVGb3JtIiwiZm9ybUlucHV0IiwicG9wdXBTYXZlQnV0dG9uIiwicG9wdXBEaXNhYmxlQnV0dG9uIiwiaW5wdXRFcnJvciIsImFjdGl2ZUVycm9yIiwibWFpbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInByb2ZpbGVGb3JtIiwiZm9ybXMiLCJwcm9maWxlIiwiY2FyZEZvcm0iLCJhZGRJbWFnZSIsIkNhcmQiLCJpdGVtIiwic2VsZWN0b3JUZW1wbGF0ZSIsImhhbmRsZUNhcmRDbGljayIsImRlbExpa2UiLCJhZGRMaWtlIiwibXlJZCIsIl9zZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJldnQiLCJfY2FyZFRlbXBsYXRlIiwidGFyZ2V0IiwiY2xvc2VzdCIsInJlbW92ZSIsIl9jYXJkUmVtb3ZlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9kZWxldGVJbWFnZSIsIl9jYXJkTGlrZSIsIl9saWtlIiwiX2dldExpa2VzIiwiX2RlbExpa2UiLCJfY2FyZElkIiwiY29uc29sZSIsImxvZyIsIl9hZGRMaWtlQ291bnRlciIsIl9hZGRMaWtlIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiX2NhcmRJbWFnZSIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfbmV3Q2FyZE5hbWUiLCJfaW1hZ2VMaW5rIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiZmluZCIsIl9pZCIsIl9teUlkIiwiYWRkIiwiX2xpa2VOdW1iZXIiLCJ0ZXh0Q29udGVudCIsInRoaXMiLCJuYW1lIiwibGluayIsImxpa2VzIiwiX2dldFRlbXBsYXRlIiwiX2NhcmROYW1lIiwiX2NoZWNrTGlrZXMiLCJzZXRBdHRyaWJ1dGUiLCJfYWRkRXZlbnRzIiwiU2VjdGlvbiIsInNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJpbm5lckhUTUwiLCJjbGVhciIsImZvckVhY2giLCJpdGVtSHRtbCIsInByZXBlbmQiLCJhcHBlbmQiLCJGb3JtVmFsaWRhdG9yIiwibGlzdCIsImZvcm1BY3RpdmUiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfaW5wdXRBcnJheSIsImlucHV0cyIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJ2YWxpZEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckluRWxlbWVudCIsIl9mb3JtIiwiaWQiLCJfaW5wdXRFcnJvciIsIl9hY3RpdmVFcnJvciIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInNvbWUiLCJpbnB1dEVsZW1lbnQiLCJfaGFzSW52YWxpZElucHV0IiwiX3NhdmVCdXR0b24iLCJfcG9wdXBEaXNhYmxlQnV0dG9uIiwicmVtb3ZlQXR0cmlidXRlIiwiaW5wdXQiLCJfYWN0aXZlRm9ybSIsIl9mb3JtSW5wdXQiLCJfcG9wdXBTYXZlQnV0dG9uIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIlBvcHVwIiwiX2VzY0Nsb3NlTGlzdGVuIiwia2V5IiwiY2xvc2UiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiX2Nsb3NlTGlzdGVuZXIiLCJjdXJyZW50VGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhJbWFnZSIsIl9iaWdJbWFnZSIsIl9iaWdJbWFnZUNhcHRpb24iLCJQb3B1cFdpdGhGb3JtIiwic3VibWl0Rm9ybSIsIl9zdWJtaXRGb3JtIiwibmV3VmFsdWVzIiwidmFsdWUiLCJfc3VibWl0TGlzdGVuZXIiLCJwcmV2ZW50RGVmYXVsdCIsIl9nZXRJbnB1dFZhbHVlcyIsInJlc2V0IiwiVXNlckluZm8iLCJ1c2VyTmFtZSIsImRlc2NyaXB0aW9uIiwiX25hbWUiLCJfZGVzY3JpcHRpb24iLCJkZXNjcmlwdCIsIm5ld0lucHV0cyIsIkFwaSIsImZvclVybCIsIl91cmwiLCJfdG9rZW4iLCJfZm9yVXJsIiwiX2hlYWRlcnMiLCJmZXRjaCIsImhlYWRlcnMiLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsIm1ldGhvZCIsImlucHV0TmFtZSIsImVsZW1lbnRzIiwiaW5wdXRuRGVzY3JpcHQiLCJwcm9maWxlT3BlbkJ1dHRvbiIsImNhcmRBZGRCdXR0b24iLCJnZXREYXRhIiwidXNlcnNJbmZvIiwid2luZG93IiwiY2F0Y2giLCJlcnIiLCJjYXJkTmFtZSIsImNhcmRMaW5rIiwiYmlnSW1hZ2UiLCJvcGVuIiwiY2FyZElkIiwiYXBpQ2FyZHMiLCJhZGROZXdDYXJkIiwiZGVzY3JpYmUiLCJtYWtlQ2FyZCIsImRiQ2FyZHMiLCJhZGRHYWxhcnkiLCJyZXR1cm5DYXJkIiwiYXBwZW5kcyIsInJlbmRlckl0ZW1zIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJwb3B1cENhcmRGb3JtIiwicHJlcGVuZHMiLCJ1c2VySW5mbyIsInBvcHVwUHJvZmlsZSIsInNldFVzZXJJbmZvIiwicHJvZmlsZUZvcm1WYWxpZGF0ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJjYXJkRm9ybVZhbGlkYXRlIiwicmVzZXRWYWxpZGF0aW9uIiwib2xkUHJvZmlsZSIsImdldFVzZXJJbmZvIl0sInNvdXJjZVJvb3QiOiIifQ==